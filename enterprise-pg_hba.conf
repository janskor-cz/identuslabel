# PostgreSQL Host-Based Authentication Configuration
# Enterprise Cloud Agent for Internal Departments
#
# SECURITY: Trust authentication ONLY for Docker internal network
# External connections BLOCKED (no port exposure to host)

# TYPE  DATABASE        USER                    ADDRESS                 METHOD

# Local connections (Unix socket)
local   all             all                                             trust

# Docker internal network - Trust authentication for identus_enterprise user
# Network: 172.18.0.0/16 (Docker bridge network)
host    all             identus_enterprise      172.18.0.0/16           trust

# Docker internal network - Trust authentication for Cloud Agent application users
host    all             pollux-application-user 172.18.0.0/16           trust
host    all             connect-application-user 172.18.0.0/16          trust
host    all             agent-application-user  172.18.0.0/16           trust

# Docker internal network - postgres superuser requires password
host    all             postgres                172.18.0.0/16           md5

# Allow Company Admin Portal (external Node.js server) with password authentication
host    all             identus_enterprise      0.0.0.0/0               scram-sha-256

# Block all other connections
host    all             all                     0.0.0.0/0               reject
host    all             all                     ::/0                    reject
