{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://identuslabel.cz/schemas/DocumentMetadata/1.0.0",
  "title": "DocumentMetadata",
  "description": "Zero-knowledge document registry metadata schema with issuer-based releasability",
  "type": "object",
  "properties": {
    "documentDID": {
      "type": "string",
      "description": "PRISM DID for the document",
      "pattern": "^did:prism:[a-f0-9]{64}$"
    },
    "title": {
      "type": "string",
      "description": "Document title (will be encrypted in storage)",
      "minLength": 1,
      "maxLength": 500
    },
    "description": {
      "type": "string",
      "description": "Optional document description (will be encrypted in storage)",
      "maxLength": 2000
    },
    "releasableTo": {
      "type": "array",
      "description": "Array of issuer DIDs authorized to discover this document",
      "items": {
        "type": "string",
        "pattern": "^did:prism:[a-f0-9]{64}$"
      },
      "minItems": 1,
      "uniqueItems": true
    },
    "classificationLevel": {
      "type": "string",
      "description": "Security classification level",
      "enum": [
        "PUBLIC",
        "INTERNAL",
        "CONFIDENTIAL",
        "SECRET",
        "TOP_SECRET"
      ]
    },
    "contentHash": {
      "type": "string",
      "description": "SHA-256 hash of document content",
      "pattern": "^sha256:[a-f0-9]{64}$"
    },
    "contentEncryptionKey": {
      "type": "string",
      "description": "ABE-encrypted symmetric key (base64 encoded)",
      "minLength": 1
    },
    "contentLocation": {
      "type": "string",
      "description": "Storage location (IPFS CID, S3 URI, etc.)",
      "minLength": 1,
      "maxLength": 1000
    },
    "authorDID": {
      "type": "string",
      "description": "DID of document author",
      "pattern": "^did:prism:[a-f0-9]{64}$"
    },
    "createdAt": {
      "type": "string",
      "description": "ISO 8601 timestamp of document creation",
      "format": "date-time"
    },
    "version": {
      "type": "string",
      "description": "Semantic version (e.g., 1.0.0, 1.1.0)",
      "pattern": "^\\d+\\.\\d+\\.\\d+$"
    },
    "documentType": {
      "type": "string",
      "description": "MIME type of document",
      "pattern": "^[a-z]+/[a-z0-9.+-]+$",
      "examples": [
        "application/pdf",
        "application/vnd.openxmlformats-officedocument.wordprocessingml.document",
        "text/plain",
        "image/png"
      ]
    },
    "size": {
      "type": "integer",
      "description": "File size in bytes",
      "minimum": 0,
      "maximum": 104857600
    },
    "tags": {
      "type": "array",
      "description": "Optional searchable tags (will be encrypted in storage)",
      "items": {
        "type": "string",
        "minLength": 1,
        "maxLength": 50,
        "pattern": "^[a-z0-9-]+$"
      },
      "maxItems": 20,
      "uniqueItems": true
    }
  },
  "required": [
    "documentDID",
    "title",
    "releasableTo",
    "classificationLevel",
    "contentHash",
    "contentEncryptionKey",
    "contentLocation",
    "authorDID",
    "createdAt",
    "version",
    "documentType",
    "size"
  ],
  "additionalProperties": false,
  "examples": [
    {
      "documentDID": "did:prism:d0c1b2a3f4e5d6c7b8a9f0e1d2c3b4a5c6d7e8f9a0b1c2d3e4f5a6b7c8d9e0f1",
      "title": "Q2 Security Incident Report",
      "description": "Analysis of Q2 2025 security incidents",
      "releasableTo": [
        "did:prism:6ee757c2913a76aa4eb2f09e9cd3cc40ead73cfaffc7d712c303ee5bc38f21bf"
      ],
      "classificationLevel": "CONFIDENTIAL",
      "contentHash": "sha256:e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855",
      "contentEncryptionKey": "ABE_ENCRYPTED_KEY_BASE64_HERE",
      "contentLocation": "ipfs://QmX...",
      "authorDID": "did:prism:f8a3b2c1d4e5f6a7b8c9d0e1f2a3b4c5d6e7f8a9b0c1d2e3f4a5b6c7d8e9f0a1",
      "createdAt": "2025-11-30T12:00:00Z",
      "version": "1.0.0",
      "documentType": "application/pdf",
      "size": 2048576,
      "tags": [
        "security",
        "incident",
        "q2-2025"
      ]
    }
  ]
}
